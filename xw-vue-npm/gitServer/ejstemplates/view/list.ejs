<template>
    <div class="le_comps_core_css">
        <h4 class="le_page_name"><%= data.PageTitle %></h4>
        <div class='le_list_search_pannel clearfix'>
            <%_ data.config.searchModel.forEach(function(col){ -%>
            <div class="<%= 'col' + data.colsCount %>"><%_ %>
                <%_ if(col.type == "text"){ -%>
                <le-input<%  _%>
                    <%_ if(col.placeholder && col.placeholder != ''){ -%>
                        <%_  %> placeholder = "<%= col.placeholder %>" <%_  -%>
                    <%_ } -%>
                    <%_ if(col.labelWidth && col.labelWidth != ''){ -%>
                        <%_  %> labelWidth="<% col.labelWidth %>"<%_  -%>
                    <%_ } -%>
                    <%_ if(col.label && col.label != ''){ -%>
                        <%_  %> label="<%= col.label %>:"<%_  -%>
                    <%_ } -%>
                    <%_ if(col.field && col.field != ''){ -%>
                        <%_  %> v-model="searchModel.<%= col.field %>"<%_  -%>
                    <%_ } -%>></le-input>
                <%_ } -%>
                <%_ if(col.type == "select"){ -%>
                <le-local-select<%  _%>
                            <%_ if(col.placeholder && col.placeholder != ''){ _%>
                                <%_  %> placeholder = "<%= col.placeholder %>"<%  -%>
                            <%_ } _%>
                            <%_ if(col.labelWidth && col.labelWidth != ''){ -%>
                                <%_  %> labelWidth="<%= col.labelWidth %>"<%  -%>
                            <%_ } _%>
                            <%_ if(col.label && col.label != ''){ -%>
                                <%_  %> label="<%= col.label %>:"<%  -%>
                            <%_ } _%>
                            <%_ if(col.field && col.field != ''){ -%>
                                <%_  %> v-model="searchModel.<%=col.field%>"<%  -%>
                            <%_ } _%>
                            <%_ if(col.dataSource && col.dataSource != ''){ -%>
                                <%_  %> :data-source="<%= col.dataSource %>"<%  -%>
                            <%_ } _%>
                            <%_ if(col.displayName && col.displayName != ''){ -%>
                                <%_  %> display-name="<%= col.displayName %>"<%  -%>
                            <%_ } _%>
                            <%_ if(col.displayValue && col.displayValue != ''){ -%>
                                <%_  %> display-value="<%= col.displayValue %>"<%  -%>
                            <%_ } _%>></le-local-select>
                <%_ } -%>
                <%_ if(col.type == "radioList"){ -%>
                <le-radio-list<%  _%>
                        <%_ if(col.labelWidth && col.labelWidth != ''){ _%>
                            <%_  %> labelWidth="<%= col.labelWidth %>"<%  -%>
                        <%_ } _%>
                        <%_ if(col.label && col.label != ''){ -%>
                            <%_  %> label="<%= col.label %>:"<%  -%>
                        <%_ } _%>
                        <%_ if(col.field && col.field != ''){ -%>
                            <%_  %> v-model="searchModel.<%=col.field%>"<%  -%>
                        <%_ } _%>
                        <%_ if(col.dataSource && col.dataSource != ''){ -%>
                            <%_  %> :data-source="<%= col.dataSource %>"<%  -%>
                        <%_ } _%>
                        <%_ if(col.displayName && col.displayName != ''){ -%>
                            <%_  %> display-name="<%= col.displayName %>"<%  -%>
                        <%_ } _%>
                        <%_ if(col.displayValue && col.displayValue != ''){ -%>
                            <%_  %> display-value="<%= col.displayValue %>"<%  -%>
                        <%_ } _%>></le-radio-list>
                <%_ } -%>
                <%_ if(col.type == "checkboxList"){ -%>
                <le-checkbox-list<%  _%>
                    <%_ if(col.labelWidth && col.labelWidth != ''){ _%>
                        <%_  %> labelWidth="<%= col.labelWidth %>"<%  -%>
                    <%_ } _%>
                    <%_ if(col.label && col.label != ''){ -%>
                        <%_  %> label="<%= col.label %>:"<%  -%>
                    <%_ } _%>
                    <%_ if(col.field && col.field != ''){ -%>
                        <%_  %> v-model="searchModel.<%=col.field%>"<%  -%>
                    <%_ } _%>
                    <%_ if(col.dataSource && col.dataSource != ''){ -%>
                        <%_  %> :data-source="<%= col.dataSource %>"<%  -%>
                    <%_ } _%>
                    <%_ if(col.displayName && col.displayName != ''){ -%>
                        <%_  %> display-name="<%= col.displayName %>"<%  -%>
                    <%_ } _%>
                    <%_ if(col.displayValue && col.displayValue != ''){ -%>
                        <%_  %> display-value="<%= col.displayValue %>"<%  -%>
                    <%_ } _%>></le-checkbox-list>
                <%_ } -%>
                <%_ if(col.type == "datepicker"){ -%>
                <le-date-picker<%  _%>
                    <%_ if(col.placeholder && col.placeholder != ''){ _%>
                        <%_  %> placeholder = "<%= col.placeholder %>"<%  -%>
                    <%_ } _%>
                    <%_ if(col.labelWidth && col.labelWidth != ''){ -%>
                        <%_  %> labelWidth="<%= col.labelWidth %>"<%  -%>
                    <%_ } _%>
                    <%_ if(col.label && col.label != ''){ -%>
                        <%_  %> label="<%= col.label %>:"<%  -%>
                    <%_ } _%>
                    <%_ if(col.field && col.field != ''){ -%>
                        <%_  %> v-model="searchModel.<%=col.field%>"<%  -%>
                    <%_ } _%>></le-date-picker>
                <%_ } -%>
                <%_ if(col.type == "timepicker"){ -%>
                <le-time-picker<%  _%>
                    <%_ if(col.placeholder && col.placeholder != ''){ _%>
                        <%_  %> placeholder = "<%= col.placeholder %>"<%  -%>
                    <%_ } _%>
                    <%_ if(col.labelWidth && col.labelWidth != ''){ -%>
                        <%_  %> labelWidth="<%= col.labelWidth %>"<%  -%>
                    <%_ } _%>
                    <%_ if(col.label && col.label != ''){ -%>
                        <%_  %> label="<%= col.label %>:"<%  -%>
                    <%_ } _%>
                    <%_ if(col.field && col.field != ''){ -%>
                        <%_  %> v-model="searchModel.<%=col.field%>"<%  -%>
                    <%_ } _%>></le-time-picker>
                <%_ } _%>
                <%_ if(col.type == "dateTimepicker"){ -%>
                <le-date-time-picker<%  _%>
                    <%_ if(col.placeholder && col.placeholder != ''){ _%>
                        <%_  %> placeholder = "<%= col.placeholder %>"<%  -%>
                    <%_ } _%>
                    <%_ if(col.labelWidth && col.labelWidth != ''){ -%>
                        <%_  %> labelWidth="<%= col.labelWidth %>"<%  -%>
                    <%_ } _%>
                    <%_ if(col.label && col.label != ''){ -%>
                        <%_  %> label="<%= col.label %>:"<%  -%>
                    <%_ } _%>
                    <%_ if(col.field && col.field != ''){ -%>
                        <%_  %> v-model="searchModel.<%=col.field%>"<%  -%>
                    <%_ } _%>
                ></le-date-time-picker>
                <%_ } _%>
            </div>
        <%_ _%><% }) -%>
        </div>
        <div class="le_search_btn_group cleatfix">
        <%_ data.btn.forEach(function(item){ -%>
            <le-button type="<%= item.btnType %>" value="<%= item.btnName %>" @click="<%= item.btnHandle %>"></le-button>
        <%_ }) _%>
        </div>
        <div class='le_table_container'>
            <table-list title="<%= data.tableTitle %>" ref='<%= data.PageName %>_ref' :options='<%= data.tableOptionsName %>'></table-list>
        </div>
        <%_ if(data.model){ _%>
        <le-dialog v-model = "dialogTag">
            <div slot = "body">
                <%_ _%><%- include("form.ejs",{data:data.model,model: data.ModuleName}) %>
            </div>
            <div slot="button">
                <le-button type="cancel" value="取消" @click = "dialogCancel"></le-button>
                <le-button type="save" value="确定"  @click = "dialogConfirm"></le-button>
            </div>
        </le-dialog>
        <%_ } -%>
    </div>
</template>
<script>
import CommonUtil from '@util';
import { createNamespacedHelpers } from 'vuex';
const { mapState, mapActions,mapMutations } = createNamespacedHelpers('<%= data.ModuleName %>Store');
<%_ if(data.model && data.model != ""){ -%>
import <%= data.ModuleName %>Model from '@model/<%= data.ModuleName %>'
<%_ } -%>
export default {
    name:"<%= data.ModuleName %><%= data.PageName %>",
    data(){
        return {
            // 搜索条件
        searchModel:{
            <%_ data.config.searchModel.forEach(function(col){ -%>
                <%_ if(col.field && col.field != ""){ -%>
                <%= col.field %> : "",
                <%_ } -%>
            <%_ }) -%>
        },
            // dialog v-model的值 控制dialog显示/隐藏
            <%_ if(data.model){ -%>
            dialogTag:false,
            <%= data.ModuleName %>: new <%= data.ModuleName %>Model(),
            <%_ } -%>
            // 表格的配置
            <%= data.tableOptionsName %>: <%= data.config.table %>
        }
    },
    computed:{
        ...mapState([
            <%_ data.config.searchModel.forEach(function(actionName){ -%>
            <%_ if (actionName.dataSource) { -%>
            "<%= actionName.dataSource%>",
            <%_ } -%>
            <%_ }) -%>
        ])
    },
    methods:{
        ...mapActions([
            <%_ data.config.searchModel.forEach(function(actionName){ -%>
            <%_ if (actionName.dataSource) { -%>
            "get<%= actionName.dataSource%>",
            <%_ } -%>
            <%_ }) -%>
        ]),
        search(){
            this.$refs["<%= data.PageName %>_ref"].search();
        },
        <%_ data.btn.forEach(function(item){ -%>
        <%= item.btnHandle%>() {

        },
        <%_ }) _%>
        <%_ if(data.model){ _%>
        dialogConfirm(){},
        dialogCancel(){
            this.dialogTag = false;
        },
        <%_ } else { -%>
        createBtn(){
            this.$router.push({path:'/<%= data.ModuleName + data.PageName %>', query: {tag: 'create'}});
        },
        updateBtn(item){
            this.$router.push({path:'/<%= data.ModuleName + data.PageName %>', query: {tag: 'edit', id: item.id}});
        },
        detailInfo(item) {
            this.$router.push({path:'/<%= data.ModuleName + data.PageName %>', query: {tag: 'detail', id: item.id}});
        }
        <%_ } -%>
        }

    },
    mounted(){
    <%_ data.config.searchModel.forEach(function(actionName){ -%>
    <%_ if (actionName.dataSource) { -%>
      this.get<%= actionName.dataSource%>()
    <%_ } -%>
    <%_ }) -%>
    }
}
</script>
<style scoped>
    
</style>
